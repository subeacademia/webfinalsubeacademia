<div id="pdf-content" class="p-4 sm:p-6 md:p-8 bg-white dark:bg-gray-900">
  <div class="max-w-4xl mx-auto">
    
    <!-- Encabezado de Resultados -->
    <div class="text-center border-b border-gray-200 dark:border-gray-700 pb-4 mb-8">
      <h2 class="text-3xl font-extrabold text-gray-900 dark:text-white">Tus Resultados del Diagnóstico</h2>
      <p class="mt-2 text-lg text-gray-600 dark:text-gray-400" *ngIf="diagnosticData">
        Análisis para {{ diagnosticData.lead.name }}
      </p>
    </div>

    <!-- Contenido Principal en 2 Columnas -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
      
      <!-- Columna Izquierda: Gráfico y Puntajes -->
      <div>
        <h3 class="text-2xl font-bold text-gray-800 dark:text-gray-200 mb-4">Visualización de Competencias</h3>
        <app-card>
          <div *ngIf="competencyResults.length > 0; else noData">
            <app-radar-chart [data]="competencyResults"></app-radar-chart>
          </div>
          <ng-template #noData>
            <p class="text-center text-gray-500 dark:text-gray-400 py-16">Calculando resultados...</p>
          </ng-template>
        </app-card>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6">
          <app-card>
            <h4 class="font-bold text-lg text-green-600 dark:text-green-400 mb-2">Principales Fortalezas</h4>
            <ul>
              <li *ngFor="let item of topCompetencies" class="flex justify-between py-1">
                <span>{{ item.name }}</span>
                <span class="font-semibold">{{ item.score | number:'1.0-0' }}%</span>
              </li>
            </ul>
          </app-card>
          <app-card>
            <h4 class="font-bold text-lg text-yellow-600 dark:text-yellow-400 mb-2">Áreas de Oportunidad</h4>
            <ul>
              <li *ngFor="let item of lowestCompetencies" class="flex justify-between py-1">
                <span>{{ item.name }}</span>
                <span class="font-semibold">{{ item.score | number:'1.0-0' }}%</span>
              </li>
            </ul>
          </app-card>
        </div>
      </div>

      <!-- Columna Derecha: Análisis con IA -->
      <div>
        <h3 class="text-2xl font-bold text-gray-800 dark:text-gray-200 mb-4">Análisis y Plan de Acción por IA</h3>
        
        <div *ngIf="isLoadingAnalysis" class="p-6 rounded-lg bg-gray-100 dark:bg-gray-800 animate-pulse">
          <div class="flex items-center space-x-4">
            <div class="w-12 h-12 rounded-full bg-primary/20 flex items-center justify-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-primary animate-spin" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.75V6.25m0 11.5v1.5m-6.364-2.136l1.06 1.06M4.75 12H6.25m11.5 0h1.5m-2.136-6.364l1.06-1.06M12 20.25a8.25 8.25 0 100-16.5 8.25 8.25 0 000 16.5z" />
              </svg>
            </div>
            <div>
              <p class="text-lg font-semibold text-gray-700 dark:text-gray-300">Generando tu informe...</p>
              <p class="text-sm text-gray-500 dark:text-gray-400">{{ loadingMessage }}</p>
            </div>
          </div>
        </div>

        <div *ngIf="!(isLoadingAnalysis) && (generativeAnalysis$ | async) as analysis">
          <div class="prose prose-lg dark:prose-invert max-w-none p-6 rounded-lg bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700">
            <markdown [data]="analysis"></markdown>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Botones de Acción Fuera del Contenido del PDF -->
<div class="max-w-4xl mx-auto mt-8 px-4 sm:px-6 md:px-8 flex justify-end">
  <app-ui-button (click)="generateAndDownloadPdf()">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
      <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd" />
    </svg>
    Descargar PDF
  </app-ui-button>
</div>
